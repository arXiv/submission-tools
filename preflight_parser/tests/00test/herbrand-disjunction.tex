%
% herbrand-disjun.tex
%

\section{Herbrand Disjunctions}
\label{sec:herbrand}

In his thesis from 1930, Jacques Herbrand proved the fact, that for
all provable formulas of first order predicate logic an equivalent
one without 
quantifiers can be found. This insight, today called Herbrand's
theorem, is one of the most fundamental of mathematical logics, since
it allows the discussion of the validity of any formula just in terms
of finite means, i.e.\ in terms of propositions, and not in terms of the
abstract notation of quantifiers.

% In this section we will provide a short introduction to mathematical
% logic, especially the notations important to understand Herbrand
% disjunctions, which are basic for the following paper, are
% introduced.

We assume that the reader is familiar with the basic notations of
mathematical logic, i.e.\ the
symbols~$\land,\lor,\limp,\lequ,\lnot,\exists,\forall$ together with
the rules of forming terms out of function symbols, constants and
variables and formulas out of these terms and the above symbols.

% Furthermore we assume knowledge on the notations of prenex form,
% prefix, matrix.

%\begin{definition}[Prenex Formula]
%A formula is said to be in \emph{Prenex form} if it is of the form
%        $$ (Q_1x_1)\ldots(Q_nx_n)A(x_1,\ldots,x_n) $$
%with~$A$ quantifier-free and~$Q_i$ is either~$\forall$
%or~$\exists$. I.e.\ a formula is in prenex from when all the
%quantifiers are at the outermost level.
%\end{definition}

%The following proposition is easy to prove:

%\begin{proposition}
%For every formulas there is an equivalent one in prenex form.
%\end{proposition}

%If we talk about prenex formulas we can discern the quantifier part
%and the quantifier free part:

%\begin{definition}[Matrix, Prefix]
%Let~$B$ be a prenex formula of the form
%        $$ (Q_1x_1)\ldots(Q_nx_n)A(x_1,\ldots,x_n).$$
%Then we call~$(Q_1x_1)\ldots(Q_nx_n)$ the \emph{prefix} of~$A$
%and~$A(x_1,\ldots,x_n)$ the \emph{matrix} of~$A$.
%\end{definition}

%\beginexample
%As an example let us take the formula
%        $$ \qa xA(x) \limp ( \qa yA(y) \lor \qe zC(z)). $$
%By logical transformations it is possible to achieve the following
%equivalent prenex formula
%        $$ \qe x \qa y \qe z (A(x)\limp (B(y)\lor C(z)).$$
%The prefix is~$\qe x \qa y \qe z$ and the matrix is~$(A(x)\limp
%(B(y)\lor C(z))$.
%\endexample

%The primary object of a formal system is to provide a framework for
%proving theorems. Hence a particular important problem for any formal
%system is: Find a necessary and sufficient condition that a formula of
%this formal system is a theorem of it. This is called the
%\emph{characterization problem}. One solution to this problem was
%given by Herbrand.

%
% subsection Herbrand's theorem
%
\subsection{Herbrand's Theorem}
\label{sec:herbrand:theorem}

In this section we will present the two forms of Herbrand's Theorem
currently used. In the following we will \emph{not} restrict ourselves
to prenex formulas because  prenex formulas are unnatural when it
comes to mathematical theories. In Projective Geometry we will often
have to work with formulas of the following form: 
        $$(A\land B \land C) \limp D$$
where~$A$, $B$ and~$C$ can be quantified. Normally this will be the
case with~$A$, $B$ and~$C$ be axioms of Projective Geometry and~$D$
the conclusion to be proven. 

Another reason for not restricting ourselves to prenex formulas is
the computationally complex transformation of a given formula into
prenex form. 

In this context we will use \emph{matrix} of a formula, which is not
in prenex form, for the formula obtained by stripping all
quantifiers, regardless of their position within the formula. 
        
% We will at first give a characterization of validity for closed
% existential formulas, i.e.\ for formulas of the form
%        $$ \qe {x_1} \dots \qe{x_n} A(x_1,\ldots,x_n)$$
% with $A(x_1,\ldots,x_n)$ quantifier free. For this kind of formula the
% following theorem holds: 

%\begin{theorem}\label{lemma:ex} (Herbrand)
% A closed existential formula~$A$ of first order predicate logic is a
% theorem iff there is a tautology which is a disjunction of instances
% of the matrix of~$A$.
% \end{theorem}


\subsubsection{The Skolem form of Herbrand's Theorem}
\label{sec:herbrand:theorem:skolem}

Today Herbrand's Theorem is used in a slightly different way compared
to the original form. This is due to the fact that this form, let us
call it the \emph{Skolem form}, is more suitable for resolution
techniques and many other logical areas.

We will associate a closed existential formula~$\S A$ with each closed
formula~$A$. For this we will substitute special new terms into the
places of variables governed by an essentially universal
quantifier. These new terms all look the same, namely
        $$t = f(x_1,\ldots,x_n).$$
Informally speaking the variables~$x_1,\ldots,x_n$ are all the
variables from essentially existential quantifiers which are between
one universal quantifier and the next.

More formally we would transform the formula into a tree in the
following way: 

%We write all the logical connectives and function
%symbols in praefix notation. This way we can get rid of all the
%parentheses and commatas. I.e.\ the formula
%       $$A(f(x),g(y,z))\lor\qe u (B(u)\land\qa vC(u,v))$$
%will be written as
%       $$\lor Afxgyz\exists u\land Bu\forall vCuv.$$
%This is possible because all the arities are known for all function
%symbols, predicates and the logical connectives.

The tree of a constant or variable is a single node with this constant 
attached. The tree of a term is a node with the function symbol
attached and, if~$n$ is the arity of~$f$, $n$~successors with the
trees of the subterms are following. The tree of an atomic formula is
a node with the predicate symbol attached and, if~$n$ is the arity
of~$P$, $n$~successors with the trees of the terms are following. The
tree of a formula~$A\land B$ is a node with~$\land$ attached and
2~successors with the trees for~$A$ and~$B$ are following. The trees
for~$\lor$, $\limp$ and~$\lnot$ are similar. The tree for a
formula~$(Qx)A(x)$ is a node with~$(Qx)$ attached and one successor
with the tree of~$A(x)$.

Let $n$~be a node within this tree. Then the path from the top to this
node~$n$ is written as~$p_n$. If an essentially universal quantifier is
attached to this node, we compute two numbers for this node:
One is the number of essentially existential quantifiers and
one is the number of essentially universal quantifiers on the
path~$p_n$. We will write these two numbers as~$n(e,u)$. In other
words: If we have a node labeled with~$n(e,u)$ then an essentially
universal quantifier is attached to this node, there are
$e$~essentially existential quantifiers and $u$~essentially universal
quantifiers on the path from the top to the node~$n$.

Now we transform the path several times by the same procedure: If
there is no node~$n(e,0)$ then there is no essentially universal
quantifier at all and we are finished. Otherwise take one of these
nodes, a new functions symbol~$f$ with arity~$e$. Now substitute
within the subtree starting from the node~$n$ all occurrences of the
variable for the universal quantifier with the
term~$f(x_1,\ldots,x_e)$, where the~$x_i$ are the variables from the
$e$ essentially existential quantifiers on the path~$p_n$. Finally cut
out the node~$n$ since all the variables bound by the respective
quantifier are already substituted and recompute the values~$e$
and~$u$ for all nodes with essentially universal quantifiers in this
subtree. 

After repeating this process several times we finally obtain a tree
without any essentially universal quantifiers which we can transform
back into a formula, which we will call the Skolem form of the
original formula~$A$, written as~$\S A$.

\beginexample
Let~$A$ be the formula
        $$ \qe x \qa y ( A(x,y) \land \qe z \qa w B(x,z,w) )$$
then~$\S A$ is
        $$ \qe x ( A(x, f(x)) \land \qe z B(x, z, g(x,z))).$$
\nobreak\nobreak
\endexample

It is not too difficult to show the following lemma:

\begin{lemma}
A formula~$A$ is valid if and only if~$\S A$ is valid.
\end{lemma}

% We see now the use of lemma~\ref{lemma:ex}, because for a formula~$\S A$
% we can apply this lemma and obtain the following theorem:

In the light of the previous lemma we can state the Skolem form of Herbrand's theorem:

\begin{theorem}[Herbrands Theorem (Skolem form)]\label{theorem:skolem}
The validity of any formula~$A$ is equivalent to the validity of a
disjunction of instances of the matrix of~$\S A$.
\end{theorem}

\subsubsection{The original form of Herbrand's Theorem}
\label{sec:herbrand:theorem:original}

The disadvantage of the above theorem is the fact that we change the
language of our logic, we introduce new function symbols. This is a
different approach from introducing constants, since the introduction
of constants does not change the expressive power of a theory, while
the introduction of new function symbols (if they are not zero-placed)
may increase the expressive power. In his thesis Herbrand strictly
sticked to the original language and thus obtained the following form
where terms from the Herbrand universe are used.

\begin{definition}[Herbrand universe]
Let the language~$\cL$ contain at least one constant, then the set of
all terms made from the constants, the functions symbols and the
variables of~$\cL$ is called \emph{Herbrand universe}.
\end{definition}

\begin{definition}[Herbrand instance]
Let~$B$ be a quantifier free formula obtained from a closed
formula~$A$ by changing all variables bound by essential universal
quantifiers to constants, changing all variables bound by essential
existential quantifiers 
to terms of the Herbrand universe and eliminating all
quantifiers. Then we will call~$B$ a~\emph{Herbrand instance} of~$A$.
\end{definition}

\begin{theorem}[Herbrands Theorem (original form)]
For any formula~$A$ there is a disjunction~$B$ of Herbrand
instances of~$A$, such that~$A$ is valid iff~$B$ is valid.
\end{theorem}

\begin{definition}[Herbrand Disjunction]
A disjunction as mentioned in Herbrand's Theorem is called an
\emph{Herbrand disjunction} for~$A$, denoted by~$\H A$.
\end{definition}

%\beginexample
%Let~$A$ again be the formula
%        $$ \qe x \qa y \qe z \qa w B(x,y,z,w),$$
%then~$\H A$ can be
%        $$ B(t_1,c_1,u_1(c_1),d_1)\lor \cdots \lor B(t_n,c_n,u_n(c_n),d_n).$$
%\endexample

\beginnote
It is important to note, that~$\H A$ is \emph{not} uniquely defined,
but that there can be different Herbrand disjunctions for one formula.
\endnote

\subsubsection{Equivalence and translation between the two forms}
\label{sec:herbrand:theorem:equivalence}

Since $A$ is valid iff~$\H A$ is valid and~$A$ is valid iff~$\S A$ is
valid, we see that the two forms are equivalent. But how can we switch
between these two formulizations?

The general idea on how to go from the Skolem form to the Herbrand
form is to generate a Herbrand form of the Skolem form, i.e.\ 
$\HS A$. The important point is that we have to take care for the new
function symbols which have been introduced while generating the
Skolem form. That means, that in~$\HS A$ there are function symbols
\emph{not} in the original language.

But we can get rid of these function symbols by looking at the reasons
out of which an Herbrand disjunction is valid: Namely out of purely
propositional reasons. If we view the atomic propositions, which are
syntactically different, as propositional variables, the formula is a
propositional tautology.

Using this fact we can transform~$\HS A$ into a real Herbrand
disjunction of~$A$ by replacing occurrences of terms governed by
function symbols which are introduced during the process of
creating~$\S A$ with new constants. By this substitution, the
propositional structure of the formula is retained and therefore the
validity. 

\begin{theorem}
Any Skolem form~$\S A$ can be transformed into an Herbrand disjunction
of~$A$ by substitution of constants for terms introduced by the
skolemization process.
\end{theorem}

\beginproof Following the outline of the proof from above,
let~$f_1$,\ldots,$f_n$ be all the new function symbols 
in~$\S A$ and $u_1$,\ldots,$u_N$ all the syntactically different terms
or subterms in~$\HS A$, which are of the form~$f_i(\ldots)$ for
some~$i$. Without loss of generality assume that the terms are ordered
according to their term depth, deepest first. Now construct $S_N$ as
follows:
\begin{align*}
  S_0 &= \HS A\\
  S_{k+1} &= S_k[u_k\to c_k]
\end{align*}
Within~$S_N$ there is no occurrence of any of the~$f_i$ and it has the
same propositional structure as~$\HS A$ and is therefore
(semantically) equivalent to~$\S A$ which in turn is (semantically)
equivalent to~$A$. Therefore~$S_N$ is an Herbrand disjunction for~$A$.
\endproof

Combining the above proofs we can conclude with the following

\begin{theorem}
  The Herbrand form and the Skolem form of a formula are equivalent and one
  can be transformed into the other.
\end{theorem}

% Let us demonstrate this transition for the example above: Let~$A$ be
%         $$  \qe x \qa y \qe z \qa w B(x,y,z,w).$$
% We obtain for~$\S A$
%         $$\qe x \qe z B(x, f(x), z, g(x,z)).$$
% From~$\S A$ we can form~$\H{\S A}$, which looks like this:
%         $$ B(t_1,f(t_1),u_1(f(t_1)),g(t_1,u_1(f(t_1)))) \lor \cdots\lor
%            B(t_n,f(t_n),u_n(f(t_n)),g(t_n,u_n(f(t_n))))$$
% What is left to show is that we can eliminate the occurrences of the
% function symbols and change them to constants, maybe duplicating the
% formula in advance.

% \begin{lemma}
% If $A(t,f(t))$ is a closed, quantifier free, valid formula, then there
% is an equivalent formula of the form $$ A(t,c)$$
% \end{lemma}

% \beginproof Since~$A(t,f(t))$ is closed, quantifier free and valid, it
% can be viewed as a propositional formula with the different
% atomic formulas playing the role of propositional
% variables. From this point of view the formula is valid iff there is a
% tautology part of the disjunctive normal form. But if we substitute
% for any occurrence of~$f(t)$ a new constant~$c$, the tautology is not
% destroyed and therefore~$A(t,c)$ is valid.
% \endproof

% Applying this lemma to the above formula we obtain
%         $$ B(t_1,c_1,u_1(c_1),d_1) \lor \cdots\lor
%         B(t_n,c_n,u_n(c_n),d_n)$$
% which is a~$\H A$.

%
% subsection term depth minimization
%
\subsection{Minimization for Herbrand Disjunction}
\label{sec:herbrand:minimize}

% Next we want to show that for any given Herbrand disjunction an
% equivalent one can be found with a minimal term depth. Furthermore we
% will give an upper bound for the length of the terms depending on the
% length of the Herbrand disjunction. This will give us the possibility
% to find a Herbrand disjunction of given length in case one exists.


\subsubsection{Unification Procedure}
\label{sec:herbrand:minimize:unification}

We will present a short introduction to  unification. For the original
work by J.A.~Robinson see~\cite{unifi1,unifi2}.

\begin{definition}[Unification, unifiable, most general unifier]
~~\hbox{~~}~~\\
Let~$M = \{t_1,\ldots,t_n\}$ be a set of terms. We say that
a substitution~$\sigma$ is a \emph{unifier} of~$M$ if
        $$ t_1\sigma = t_2\sigma = \cdots = t_n\sigma.$$
In this case we will say that~$M$ is \emph{unifiable}.

A substitution~$\sigma$ will be called \emph{most general unifier
(mgu)} if for all unifiers~$\sigma'$ there is a substitution~$\tau$
such that $\sigma' = \sigma \tau$.
\end{definition}

It is easy to show the following proposition

\begin{proposition}
If there is a most general unifier than this mgu is uniquely
determined with the exception of naming of variables.
\end{proposition}

In the following we will show that any unifiable set of terms has
also a most general unifier. We will give a procedure how to obtain
this unifier.

\begin{theorem}[Unification Algorithm, Robinson]
For any unifiable set~$M$ of terms there is a most general unifier.
\end{theorem}

\beginproof
We start with the empty substitution~$\sigma$. As long as~$\sigma$ is
not a unifier for~$M$ we look for the first position in the
term~$t_i\sigma$ until we find a position, where at least in two
terms there are different symbols.
\begin{compactenum}
\item If none of the symbols are variables, the algorithm terminates,
the set is not unifiable.
\item One of the symbols is a variable~$x$, and in the other
term at this position a subterm~$t$ is starting. This subterm can be also
a variable, but not~$x$.
\begin{compactenum}
\item If~$x$ appears in~$t$ the algorithm terminates, the set is not
unifiable.
\item otherwise take $\sigma[x/t]$ as new~$\sigma$ 
\end{compactenum}
\end{compactenum}
The substitution obtained by this algorithm obviously is a unifier and
it is easy to show that it is also the most general unifier.
\endproof

We will use this algorithm to unify sets of pairs of terms
        $$\{(t_1,u_1),\ldots,(t_n,u_n)\}.$$
For such a case we take a new function symbol~$f$ and unify the following set
        $$\{f(t_1,\ldots,t_n), f(u_1,\ldots,u_n)\}.$$
Similar adjustments work for the unifier of atomic formulas and all
syntactical objects in general. So we will use the expression
\emph{unifier} in a very broad sense.

%
% Minimization
%        
\subsubsection{Minimization Procedure}
\label{sec:herbrand:minimize:minimize}

Our aim is the following: For a given formula~$A'$ and a given Herbrand
disjunction~$H$ for the skolemization of the formula~$A'$ we want to
find another, possibly different, Herbrand disjunction, which has
terms with smaller depth and which is, in some sense, minimal. We will
explain this concept of minimality later on.

\begin{definition} 
For every syntactic component of a formula (function symbols,
variables, predicate symbols, conjunctors, quantifiers) there is a unique
signature called the \emph{position} which describes the position
within the formula. For a position~$p$ corresponding to a predicate
symbol, the operator~$\atom(A,p)$ yields the atomic formula for this
predicate symbol.
\end{definition}

Let this Herbrand disjunction be the formula~$H$:
        $$H = A(\vec t_1, \vec T_1) \lor \ldots \lor A(\vec t_n, \vec T_n)$$
where $\vec T_i$ are (lists of) Skolem terms and~$\vec t_i$ are (lists
of) (regular) terms. 

Now we substitute new variables into the formula~$H$ for the~$t_i$ and
obtain~$H^\#$:
        $$H^\# = A(\vec x_1, \vec S_1) \lor \ldots \lor A(\vec x_n, \vec S_n)$$
Note that also the Skolem terms~$T_i$ may have changed due to the
substitution into different terms~$S_i$.
Since we only changed terms the positions of atomic formulas
within~$H^\#$ and~$H$ are the same. We construct the set~$M$ of all
pairs of positions, whose corresponding atomic formulas are equal in~$H$,
i.e.: 
        $$M = \{ (p_i, p_j)\quad | \quad\atom(H,p_i) = \atom(H,p_j)\}$$
Finally we construct the equality system~$G$ consisting of all the
atomic formulas in~$H^\#$, which are equal in~$H$:
        $$G = \{ \atom(H^\#,p_i) = \atom(H^\#, p_j)\quad 
                   |\quad (p_i,p_j) \in M\}$$
This equality system has a solution, namely the original substitution
which we used to obtain the skeleton~$H^\#$ from~$H$.

\begin{definition} [Herbrand Skeleton]
The formula~$H^\#$ obtained from~$H$ by substituting new variables for
the terms occuring in the formula is called \emph{Herbrand
Skeleton}. See fig.~\ref{fig:skeleton} for an example.
\end{definition}

\begin{figure}[ht]
  \[\epsfbox{skelett.eps}\]
  \caption[Herbrand Skeleton]{Herbrand Skeleton (\copyright\ 2001 Brigitte Lindner)}
  \label{fig:skeleton}
\end{figure}

This equality system describes the connections between the atomic
formulas within~$H$ which render~$H$ true, i.e. make a tautology out
of it. 

But a tautology can be true by various reasons. For example take a
long formula with very complicated parts which is a tautology and then
add an~$\lor\true$. If we `compute' the truth of this new formula with
the complicated first part it will be very difficult, if we take
the~$\lor\true$ part, it will be very easy. Exactly the same
situation can occur with the above tautologies. Therefore we try to
find a minimal set of connections which render the Herbrand
disjunction true. As a result of this we also obtain terms which are
for sure not longer than the original ones.

We now take one element~$g$ from the power set of~$G$, i.e.\ a
subsystem of~$G$. Every element of the power set also has at least one
solution, namely the projection of the original substitution, but
there may be more. Now we take a look at all the solutions of~$g$ and
check for the property, that the solution produces a tautology
from~$H^\#$. If this is the case we have obtained a more simple
connection set within the Herbrand disjunction.

%\begin{itemize}
%\item Die LÅˆsungssubstitution macht aus~$H^\#$ eine Tautologie.
%\item Von dieser Tautologie lÅ‰sst sich durch Reskolemisierung die
%        ursprÅ¸ngliche Formel erstellen. 
%\end{itemize}

We will call an equality system~$g$ with such a solution
\emph{alternative}.

All these alternative equality systems make up a tree where the root
is the original~$G$ and going down the tree gives smaller and smaller
systems. In each branch there is a~$g$ which is the smallest one. From
all these~$g$ we can take one of those, which have the smallest number
of equalities, i.e.\ the smallest number of necessary connections to
render the Herbrand disjunction true.

Finally we want to show how it is possible to obtain the original
formula~$A'$ from the modified Herbrand disjunction, ie.\ from a
Herbrand disjunction obtained by applying a solution of an alternative
equality system to the skeleton~$A^\#$. The process is called
\emph{reskolemization}.

Let~$G$ be such a modified Herbrand disjunction and~$A'$ the original
formula. Every position of a quantified variable in~$A'$ matches with
more (depended on the number of disjunctions in~$G$) positions
in~$G$. We call a position~$p$ of a quantified variable in~$G$
\emph{weak} or \emph{strong} dependent on the status of the matching
variable in~$A'$.

\medskip
\textbf{Algorithm: Reskolemization of infix formulas}
\begin{enumerate}
\item Fix a sequence of all Skolem terms with decreasing term depths
\item Take the first term and search all weak positions where this
        term occurs. 
\item Introduce an existential quantifier for this term and shift it
        inward as long as possible.
\item Introduce the strong quantifier for this term and shift it
        inward as long as possible. If this is not possible start with
        a new sequence. 
\item Restart with one of the deepest terms.
\end{enumerate}

This procedure is non-deterministic because there may be more valid
sequences of Skolem terms. The case that it is not possible to
introduce the strong quantifier because of the eigenvariable condition
can happen when we have chosen to start with the wrong Skolem terms,
ie.\ we tried to introduce `wrong' quantifiers first.

\begin{theorem}
For any Herbrand disjunction it is possible to find another Herbrand
disjunction with the same skeleton but with a minimal number of
connections within the Herbrand disjunction. We will call such an \hd
\emph{minimal}. 
\end{theorem}

% Let us start with the Herbrand disjunction
%          $$ A(\bar t_1)\lor\cdots\lor A(\bar t_n) $$
% and number the atoms. Let the numbered atoms be $P_1,\ldots,P_n$.
% Since this is a Herbrand disjunction it must be valid and closed and
% therefore we can consider the different atoms as propositional
% variables and these variables must form a tautology. Now we
% substitute $\bar x_1, \ldots, \bar x_n$ for $\bar t_1, \ldots, \bar t_n$
% and obtain 
%         $$  A(\bar x_1)\lor\cdots\lor A(\bar x_n)$$
% Normally this will not be a tautology in the new atoms anymore, but
% there is a substitution~$\sigma$ such that
%         $$(A(\bar x_1)\lor\cdots\lor A(\bar x_n))\sigma =  A(\bar
%         t_1)\lor\cdots\lor A(\bar t_n) $$
% We will call the formula $A(\bar x_1)\lor\cdots\lor A(\bar x_n)$ the
% \emph{Herbrand skeleton} of~$A$.
% %Now take out any pair of atoms which are equal under this substitution,
% %i.e. construct the set $\cU$:
% %        $$\cU := \{ (P_i,P_j) : P_i\sigma = P_j\sigma \} $$
% Next step is that we look at all the substitutions on the
% Herbrand skeleton which transforms it into a tautology and which are
% minimal in the sense, that if we take out on particular substitution
% on a variable, the resulting one does not produce a tautology.
% Afterwards we have to check wether these tautologies can be
% transformed into the original formula by introduction of
% quantifiers. This is necessary since after a substitution constants
% may appear in places where they disturb the introduction of
% quantifiers.  

% There is another approach on how to find valid substitutions: We could
% not use Herbrand constants but Skolem terms in the Herbrand
% disjunction. This way search for substitutions would only yield valid
% ones with respect to the introduction of the quantifiers. But there
% may be a drawback. When using Skolem terms we restrict ourselves to
% the particular ordering of quantifiers in the orginial formula. But we
% may obtain a simpler, but still equivalent, formula by shifting of
% quantifiers which has the same Herbrand disjunction. The method using
% constants therefore is somehow more general, since it may yield a
% different ordering and simpler formulas.

% In any case way we obtain a set of substitutions which are minimal in
% the sense that no part of one of it can be left out and that all of
% them produce a tautology from the skeleton.

% Within this set of substitution we can now minimize for different
% purposes: Either for minimal term depth, minimal number of lines or
% points, minimal formula complexity within the relevant part, or
% anything else.

% The point is that there is no `minimal' solution in any usual sense,
% which is unique. We could take the mgu of the set
%         $$\cU := \{ (P_i,P_j) : P_i\sigma = P_j\sigma \} $$
% of all pairs of atoms which are equal under the first substitution,
% but this may easily produce a to complex tautology. Take for example
% the formula
%         $$\qa u\qe v\qe w(P(u)\lor\lnot P(v)\lor\lnot P(w))$$
% which has a (not `the') Herbrand disjunction 
%         $$P(c)\lor\lnot P(c)\lor\lnot P(c).$$
% The skeleton is
%         $$P(x)\lor\lnot P(y)\lor\lnot P(z).$$
% And the substitution $\sigma$ take~$x, y, z$ to~$c$. Now there are to
% simpler substitution, namely the two where only one of~$y$ or~$z$ are
% taken to~$c$, because both of these produce a tautology.

% So we see that the concept of `minimality' within this framework is
% rather unclear, but it is necessary we can minimize on various aims.


% To find the ``minimal'' solution we have to find a minimal
% substitution which produces a tautology.

% For the usual usage of Herbrands theorem and Skolem functions this is
% an easy task, since the form of the terms prevent the unification
% algorithm to produce invalid substitutions, i.e.\ the dependencies of
% the terms are obeyed.

% In the case of usage of the original form we have to be careful, since
% we assume that there are not general terms, but constants and terms of
% the Herbrand universe. We therefore have to be careful in using a
% method to obtain a most general unifier, because some constants can
% occur after the unification on ``wrong places''.

% To solve this problem there are two tactics, both usable: First we can
% take all the possible unifications and eliminate afterwards all
% invalid ones, i.e.\ these unifications which produce an invalid
% ordering of the quantifiers. 

% On the other hand we can write the constants coming from
% the universal quantifiers as Skolem functions while considering them
% as constants. Then the usual unification procedures, which takes into
% account the substitution order, would give us a valid mgu.

% Both methods are valid, so let us call the mgu~$\sigma_M$. We
% therefore obtain that
%         $$(A(\bar x_1)\lor\cdots\lor A(\bar x_n))\sigma_M$$
% is an equivalent Herbrand disjunction with minimal terms.

%\begin{lemma}
% For any given Herbrand Disjunction the above procedure produces an
% equivalent Herbrand Disjunction with minimal term depth compared to
% all Herbrand Disjunctions with length less than or equal to the
% original one.
%\end{lemma}

% \beginproof The validity of the new Herbrand disjunction is obvious
% from the construction, what is left to show is the minimality of the
% term depths.

% \def\depth{\textrm{depth}}

%Now imagine there is a Herbrand disjunction~$B = A(u_1)\lor\cdots\lor
%A(u_k)$ with $\max\depth u_i < \max\depth \bar
%x_i\sigma_M$. Since~$k\le n$ according to the lemma we can build~$B'$: 
%        $$(A(\bar x_1)\lor\cdots\lor A(\bar x_n))%
%                [\bar x_{k+1}\to \bar x_1,\ldots,\bar x_n\to \bar x_1]%
%                 [\bar x_1\to u_1,\ldots, \bar x_k\to u_k]$$
% is nothing else than
%         $$A(u_1)\lor\cdots\lor A(u_k)\lor A(u_1)\lor\cdots\lor
%         A(u_1)$$
% we obtain that the maximal term-depth of~$B'$ is the maximal
% term-depth of~$B$ which in turn is less than or equal to the maximal
% term-depth of the one constructed according to the properties of the mgu.
% \endproof

% \beginnote It is important to note that the theorem states ``for any
% given'' Herbrand disjunction: If we start from an Herbrand disjunction,
% we obtain a unique minimal one. But if we start from a provable
% formula we may obtain different Herbrand disjunctions, due to the fact
% that a formula can be valid out of different reasons, which would be
% reflected in the Herbrand disjunction. And so we would also get
% different minimal ones. So one crucial point here is the fact how we
% obtain an Herbrand disjunction fixes also our minimal length.
% \endnote

\subsubsection{Length Estimations}
\label{sec:herbrand:minimize:length}

It is possible to estimate the length of the deepest term
in the \hd of a formula: this is just the usual bound coming from the
construction of the most general unifier, namely $|t| \le d 2^{|V|}$,
where~$d$ is the maximal term depth before starting the unification
and~$|V|$ is the number of variables occuring in the terms~$t$.

\begin{lemma}
The length of a given term in any minimal Herbrand disjunction is
bound by the following formula:
        $$|t| \le d 2^{kl}$$
where $d$ is the maximal depth of the Herbrand skeleton of~$A$, $k$
the length of the Herbrand disjunction and $l$ the number of variable
places (or the number of quantified variables) in one instance (and
therefore in all instances) of~$A$ in the Herbrand disjunction.
\end{lemma}

\beginproof
This is obvious from the construction of the most general unifier.
\endproof

Now we have all the ingrediences to prove the following lemma on how
to find an Herbrand disjunction of a given length. 

\begin{corollary}
For any formula~$A$ and any integer~$k$ it is possible to check whether
there is an Herbrand disjunction for~$A$ with length smaller than~$k$
and if there is one it is possible to find it.
\end{corollary}

\beginproof For any~$k$ starting from~1 we construct all the terms
with depth less than the upper bound given in the above lemma and try
all the combinations for substituting these terms into the variables
of the disjunction and check for a tautology. Since there is only a
finite set of terms for any~$k$ the procedure terminates for any~$k$.


\subsection{Estimations of the length of Herbrand disjunctions}
\label{sec:herbrand:estimations}
\begin{definition}
The \emph{length} of a Herbrand disjunction $H$, denoted by $|H|$, is
the number of disjunction terms\footnote{See \cite{BaazLeitsch92APAL}
for the definition of the Herbrand complexity.}.

With $\HD(A)$ we denote an Herbrand disjunction which is minimal in
terms of the length.

With $\HD_\cM(A)$, where $\cM$ is a model of~ $A$, we denote the
minimal Herbrand disjunction which is equivalent to $A$ in the model
$\cM$. 
\end{definition}

In the following when we speak of the Herbrand disjunction of a
formula, it is supposed that this formula is provable, otherwise there
would be no Herbrand disjunction.

The difference between $\HD(A)$ and $\HD_\cM(A)$ is simply the fact,
that in certain models of $A$ the original Herbrand disjunction can
collapse because of additional identities.

In the following we want to estimate the length of a \hd from
below. This will later be used to prove a non-elementary speedup
from sketches to proofs with cuts (sec.~\ref{sec:orevkov}).

%Together with the translation from \hd to proofs given in
%sec.~\ref{sec:sketch} we can conclude that the sketches for formulas
%of the Orevkov sequence have awfully big lengths. 

The technique used will be to simplify the \hd to more and more simple
formulas while keeping a bound of the length. We will use some lemmas
which will we now prove:

\begin{lemma}\label{lemma:hd-theory-model}
If $\cM$ is a model of $A$ then the Herbrand disjunction of $A$ in
$\cM$ is not longer than the (general) Herbrand disjunction, i.e.
        $$ |\HD_\cM(A)| \le |\HD(A)| $$
\end{lemma}

\beginproof Assume $|\HD_\cM(A)|>|\HD(A)|$. Since $A$ is equivalent
to~$\HD(A)$ we get that $\HD(A)$ is also valid in $\cM$ and since
 $\HD(A)$ is also an Herbrand disjunction which is shorter than
 $\HD_\cM(A)$,  this is a 
contradiction to the definition of $\HD_\cM(A)$.\endproof

\begin{lemma}\label{lemma:hd-a-and-b}
The Herbrand disjunction of $A\land B$ (in $\cM$) is not shorter than
the Herbrand disjunction of $A$ (in $\cM$), i.e.
        $$|\HD_{(\cM)}(A)|\le|\HD_{(\cM)}(A\land B)|$$
\end{lemma}

\beginproof Since~$A\land B$ implies $A$ the \hd of~$A\land B$ implies the \hd
of~$A$. Therefore from a \hd of $A\land B$ we would get an \hd of $A$ which is
shorter than $\HD(A)$, which is a contradiction.
\endproof 

%\begin{lemma}\label{lemma:hd-a-or-b}
%If $B$ is not valid in $\cM$ and is of bounded complexity, then there is
%an atmost exponential function~$f$ such that
%        $$|\HD_\cM(A)|\le f(|\HD_\cM(A\lor B)|).$$
%\end{lemma}

\begin{lemma}\label{lemma:hd-exists}
If there is only one witness for~$\qe xA(x)$ in a model $\cM$
and~$A(t)$ is valid in~$\cM$, then the Herbrand disjunction of
$A(t)$ in $\cM$ is not longer than the Herbrand disjunction of $\qe
xA(x)$ in $\cM$, i.e.  
        $$|\HD_\cM(\qe xA(x))|\ge|\HD_\cM(A(t))|.$$
\end{lemma}

\beginproof Let $A(t_1)\lor\ldots\lor A(t_n)$ be the \hd
of~$\qe xA(x)$. In the model all the~$t_i$ collapse to a single~$t$,
which proves the lemma.
\endproof



\endinput

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "paper"
%%% End: 

